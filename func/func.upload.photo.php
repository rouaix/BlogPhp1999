<?php$images = array("png","jpg","jpeg");$target = "images/photos/"; // Repertoire cible$max_size = 2500000000; // Taille max en octets du fichierif(isset($_SESSION["userid"])&& @$_SESSION["userid"]!="" && @$_SESSION["userid"]!="Visiteur"){  if($_SESSION["img_type"]=="user"){    $NomDuFichier = ucfirst($_SESSION["img_type"])."_".$_SESSION["userid"];    while (list($key, $val) = each($images)){      $x = "images/photos/".ucfirst($_SESSION["img_type"])."_".$_SESSION["userid"].".".$val;      if(file_exists($x)){unlink($x);}    }      }else{    $NomDuFichier = ucfirst($_SESSION["img_type"])."_".$_SESSION["img_id"];    while (list($key, $val) = each($images)){      $x = "images/photos/".ucfirst($_SESSION["img_type"])."_".$_SESSION["img_id"].".".$val;      if(file_exists($x)){unlink($x);}    }   }  if(@$_FILES['fichier']['name']){      $_FILES['fichier']['name'] = ucfirst(strtr($_FILES['fichier']['name'],' ÀÁÂÃÄÅÇèéÊËÌÍÎÏÒÓÔÕÖÙÚÛÜ¯àâãäåçèéêëìíîï©£òóôõöùúûü~ÿ-','_AAAAAACEEEEIIIIOOOOOUUUUYaaaaaceeeeiiiioooooouuuuyyy_'));    $taille = $_FILES['fichier']['size'];    $tmp = $_FILES['fichier']['tmp_name'];    $fin = explode(".",$_FILES['fichier']['name']);        if($fin[0] == $fin[count($fin)-1]){      $ext = ".inc";    }else{      $ext = ".".strtolower($fin[count($fin)-1]);    }        if(!in_array($ext,$images)){      if($_FILES['fichier']['name']){        $infos_fichier = filesize($_FILES['fichier']['tmp_name']);        if(($taille <= $max_size)){                    if(@move_uploaded_file($_FILES['fichier']['tmp_name'],$target.$NomDuFichier.$ext)){              //$_SESSION["alerte"].="<b>Fichier envoy&eacute; !</b>";              //$_SESSION["alerte"].="<br><b>Fichier :</b> ".$_FILES["fichier"]["name"]." <b>Vers</b> ".$NomDuFichier.$ext;              //$_SESSION["alerte"].=" <b>Taille :</b> ".round($_FILES["fichier"]["size"]/1000000,1)." Mo";          }else{              $_SESSION["alerte"].= "<b>Transfert impossible !</b> ".$_FILES["fichier"]["error"];          }        }else{           $_SESSION["alerte"].= "<b>Transfert impossible !</b> <p>Le poids de votre fichier est de <b>".round($taille/1000000,1)." Mo</b> pour un poids maximum autoris&eacute; de <b>".round($max_size/1000000,1)." Mo</b>";        }      }else{        $_SESSION["alerte"].= "<b>Transfert impossible !</b> <p>Le nom du fichier est inconnu: ".$_FILES["fichier"]["name"];      }    }else{      $_SESSION["alerte"].= "<b>Transfert impossible !</b> <p>Type de fichier interdit: ".$_FILES["fichier"]["name"];    }     }  //$_SESSION["alerte"].= "<p>".$target.$NomDuFichier.$ext;}unset($_FILES['fichier']);unset($_SESSION["img_type"]);unset($_SESSION["img_id"]);?>